let r=new Map,m=(i=Symbol(),s=1)=>{if(r.has(i))return r.get(i);let o=0,e,a,l=d=>{e?a=a.i={e:d}:a=e={e:d}},t={acquire:()=>++o<=s?Promise.resolve():new Promise(l),release(){e?.e(),e=e?.i,o&&!--o&&r.delete(i)},size:()=>o};return r.set(i,t),t};export{m as getSemaphore};
